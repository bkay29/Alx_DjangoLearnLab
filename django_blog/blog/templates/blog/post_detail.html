{% extends 'base.html' %}

{% block title %}{{ object.title }} | Django Blog{% endblock %}

{% block content %}
<article class="post-detail">
    <h1>{{ object.title }}</h1>
    <p><strong>By:</strong> {{ object.author.username }} | 
       <strong>Posted:</strong> {{ object.published_date|date:"M d, Y H:i" }}</p>
    <div class="post-body">
        {{ object.content|linebreaks }}
    </div>

    {# ----------------- Tags (NEW) ----------------- #}
    {% if object.tags.all %}
      <p style="margin-top:0.75em;">
        <strong>Tags:</strong>
        {% for tag in object.tags.all %}
          <a href="{% url 'blog:posts-by-tag' tag.name %}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
        {% endfor %}
      </p>
    {% endif %}
    {# ---------------------------------------------- #}

    {% if user.is_authenticated and user == object.author %}
        <div class="actions">
            <a href="{% url 'blog:post-update' object.pk %}" class="btn">Edit</a>
            <a href="{% url 'blog:post-delete' object.pk %}" class="btn danger">Delete</a>
        </div>
    {% endif %}
</article>

<!-- ========== Comments section ========== -->
<section class="comments" style="margin-top:2em;">
  <h2>Comments</h2>

  {% comment %}
    Use object.comments.all() thanks to related_name='comments' on Comment.post
  {% endcomment %}
  {% if object.comments.exists %}
    {% for comment in object.comments.all %}
      <div class="comment" style="border-bottom:1px solid #e6e6e6; padding:0.75em 0;">
        <p style="margin:0;">
          <strong>{{ comment.author.username }}</strong>
          <small> — {{ comment.created_at|date:"M d, Y H:i" }}</small>
        </p>
        <p style="margin:0.5em 0;">{{ comment.content|linebreaksbr }}</p>

        {% if user.is_authenticated and comment.author == user %}
          <p style="margin-top:0.5em;">
            <a href="{% url 'blog:comment-edit' pk=comment.pk %}">Edit</a> |
            <a href="{% url 'blog:comment-delete' pk=comment.pk %}">Delete</a>
          </p>
        {% endif %}
      </div>
    {% endfor %}
  {% else %}
    <p>No comments yet — be the first to comment!</p>
  {% endif %}

  <div class="


